<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f0f13">
    <title>Sana Ã–zel â¤ï¸</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">
    <!-- Preconnect for Image CDN -->
    <link rel="preconnect" href="https://images.unsplash.com">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- AOS Library for scroll animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css?v=3">
    <link rel="stylesheet" href="css/games.css?v=3">
    <link rel="stylesheet" href="css/extra.css?v=3">

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- PWA / iOS Web App Settings -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/img/icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Home">
</head>

<body>

    <!-- 1. GÄ°RÄ°Å EKRANI (Butonlu) -->
    <div id="login-screen">
        <div class="login-content">
            <button id="enter-btn" class="key-btn">
                <i class="fas fa-key"></i> Eve Gir
            </button>
        </div>
    </div>

    <!-- 1.5. PROFÄ°L SEÃ‡Ä°M EKRANI (YENÄ°) -->
    <div id="profile-selection-screen" class="hidden">
        <div class="profile-content">
            <h2 class="profile-title" data-aos="fade-down">Hangi Karaktersin?</h2>
            <div class="profile-container">
                <!-- TavÅŸan KartÄ± -->
                <div class="profile-card" id="select-rabbit">
                    <div class="profile-emoji">ğŸ°</div>
                    <h3>TavÅŸan</h3>
                </div>
                <!-- Tilki KartÄ± -->
                <div class="profile-card" id="select-fox">
                    <div class="profile-emoji">ğŸ¦Š</div>
                    <h3>Tilki</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- ANA Ä°Ã‡ERÄ°K (Oda SeÃ§imi) -->
    <main id="main-content" class="hidden">
        <div id="room-selection">
            <h2 class="room-title" data-aos="fade-down">Nereye Gitmek Ä°stersin?</h2>
            <div class="rooms-container">
                <div class="room-card" id="btn-meeting" data-aos="fade-up">
                    <div class="room-img" style="background-image: url('assets/img/meeting_room.png');" loading="lazy">
                    </div>
                    <div class="room-info">
                        <h3>BuluÅŸma OdasÄ±</h3>
                    </div>
                </div>

                <!-- Åiir OdasÄ± KartÄ± -->
                <div class="room-card" id="btn-poetry" data-aos="fade-right">
                    <div class="room-img" style="background-image: url('assets/img/poetry_room.png');"></div>
                    <div class="room-info">
                        <h3>Åiir OdasÄ±</h3>
                    </div>
                </div>

                <!-- MÃ¼zik OdasÄ± KartÄ± (YENÄ°) -->
                <div class="room-card" id="btn-music" data-aos="fade-up">
                    <div class="room-img" style="background-image: url('assets/img/music_bg.jpg');"></div>
                    <div class="room-info">
                        <h3>ğŸµ MÃ¼zik OdasÄ±</h3>
                    </div>
                </div>

                <!-- AnÄ± OdasÄ± KartÄ± -->
                <div class="room-card" id="btn-memory" data-aos="fade-left">
                    <div class="room-img" style="background-image: url('assets/img/memory_room.png');"></div>
                    <div class="room-info">
                        <h3>AnÄ± OdasÄ±</h3>
                    </div>
                </div>

                <!-- Oyun OdasÄ± KartÄ± (YENÄ°) -->
                <div class="room-card" id="btn-game" data-aos="fade-up">
                    <div class="room-img" style="background-image: url('assets/img/game_room.png');"></div>
                    <div class="room-info">
                        <h3>ğŸ® Oyun OdasÄ±</h3>
                    </div>
                </div>

                <!-- Ã‡alÄ±ÅŸma OdasÄ± KartÄ± (YENÄ°) -->
                <div class="room-card" id="btn-working" data-aos="fade-up">
                    <div class="room-img" style="background-image: url('assets/img/working_room.png');"></div>
                    <div class="room-info">
                        <h3>ğŸ’¼ Ã‡alÄ±ÅŸma OdasÄ±</h3>
                    </div>
                </div>

                <!-- Ã–zel Oda KartÄ± (YENÄ°) -->
                <div class="room-card" id="btn-private" data-aos="fade-up">
                    <div class="room-img"
                        style="background-color: #2c3e50; display: flex; justify-content: center; align-items: center;">
                        <i class="fas fa-exclamation" style="font-size: 5rem; color: #e74c3c;"></i>
                    </div>
                    <div class="room-info">
                        <h3>ğŸ”’ Ã–zel Oda</h3>
                    </div>
                </div>

                <!-- Ã‡alÄ±kuÅŸu OdasÄ± KartÄ± (YENÄ°) -->
                <div class="room-card" id="btn-calikusu" data-aos="fade-up">
                    <div class="room-img"
                        style="background-image: linear-gradient(135deg, #FFB7B2 0%, #FF9AA2 100%); display: flex; justify-content: center; align-items: center;">
                        <span style="font-size: 4rem;">ğŸ¦</span>
                    </div>
                    <div class="room-info">
                        <h3>Ã‡alÄ±kuÅŸunun DÃ¼nyasÄ±</h3>
                    </div>
                </div>

                <!-- Ä°ngilizce OdasÄ± KartÄ± (YENÄ°) -->
                <div class="room-card" id="btn-english" data-aos="fade-up">
                    <div class="room-img"
                        style="background-image: linear-gradient(135deg, #3498db 0%, #2980b9 100%); display: flex; justify-content: center; align-items: center;">
                        <span style="font-size: 4rem;">ğŸ‡¬ğŸ‡§</span>
                    </div>
                    <div class="room-info">
                        <h3>English Academy</h3>
                    </div>
                </div>
            </div>


        </div>

        <!-- ODA Ä°Ã‡ERÄ°KLERÄ° -->
        <section id="poetry-room" class="room-section hidden">
            <!-- Arka Plan -->
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <!-- UÃ§uÅŸan Åiir Ä°simleri AlanÄ± -->
            <div id="floating-area">
                <!-- JS ile buraya ÅŸiir baÅŸlÄ±klarÄ± eklenecek -->
            </div>

            <!-- Åiir Okuma ModalÄ± (ParÅŸomen) - BaÅŸlangÄ±Ã§ta Gizli -->
            <div id="poem-modal" class="hidden overlay-modal">
                <button class="close-modal-btn" onclick="closePoemModal()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="parchment-wrapper">
                    <div class="parchment">
                        <h2 class="poem-title" id="modal-poem-title">BaÅŸlÄ±k</h2>
                        <div class="poem-body" id="modal-poem-body">
                            <!-- Åiir iÃ§eriÄŸi buraya gelecek -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Åiir Ekleme Butonu (Sol Alt) -->
            <button id="add-poem-fab" onclick="toggleAddPoemForm()">
                <i class="fas fa-feather-alt"></i> Åiir Ekle
            </button>

            <!-- Åiir Ekleme Formu -->
            <div id="new-poem-form" class="hidden overlay-modal">
                <div class="form-card">
                    <h3>Yeni Åiir Yaz ğŸ–‹ï¸</h3>
                    <input type="text" id="new-poem-title" placeholder="Åiir BaÅŸlÄ±ÄŸÄ±...">
                    <textarea id="new-poem-body" placeholder="Ä°Ã§indeki dÃ¶k..."></textarea>
                    <div class="form-buttons">
                        <button onclick="saveNewPoem()" class="save-btn">Kaydet</button>
                        <button onclick="toggleAddPoemForm()" class="cancel-btn">Ä°ptal</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="memory-room" class="room-section hidden">
            <!-- AnÄ± OdasÄ± Arka PlanÄ± -->
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <h1 class="memory-title" data-aos="fade-down">AnÄ±larÄ±mÄ±z</h1>

            <!-- 3x3 Resim Ã‡erÃ§evesi Galeri -->
            <div class="frame-container" data-aos="zoom-in">
                <div class="grid-3x3">
                    <!-- 9 Adet Slot - JS ile kontrol edilecek -->
                    <div class="frame-slot" id="slot-1">
                        <img id="img-1"
                            src="https://images.unsplash.com/photo-1516961642265-531546e84af2?q=60&w=800&auto=format&fit=crop"
                            alt="Memory" loading="lazy">
                    </div>
                    <div class="frame-slot" id="slot-2">
                        <img id="img-2"
                            src="https://images.unsplash.com/photo-1529619768328-e37af76c6fe5?q=60&w=800&auto=format&fit=crop"
                            alt="Memory" loading="lazy">
                    </div>
                    <div class="frame-slot" id="slot-3">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-3" class="hidden" src="" alt="Memory">
                    </div>
                    <div class="frame-slot" id="slot-4">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-4" class="hidden" src="" alt="Memory">
                    </div>
                    <div class="frame-slot" id="slot-5">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-5" class="hidden" src="" alt="Memory">
                    </div>
                    <div class="frame-slot" id="slot-6">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-6" class="hidden" src="" alt="Memory">
                    </div>
                    <div class="frame-slot" id="slot-7">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-7" class="hidden" src="" alt="Memory">
                    </div>
                    <div class="frame-slot" id="slot-8">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-8" class="hidden" src="" alt="Memory">
                    </div>
                    <div class="frame-slot" id="slot-9">
                        <div class="empty-placeholder"><i class="fas fa-image"></i><br>BoÅŸ</div>
                        <img id="img-9" class="hidden" src="" alt="Memory">
                    </div>
                </div>
            </div>

            <!-- Yeni AnÄ± Ekleme Butonu (FAB) -->
            <button id="add-memory-btn" onclick="openAddMemoryMenu()">
                <i class="fas fa-plus"></i> AnÄ± Ekle
            </button>

            <!-- Lightbox (Resim BÃ¼yÃ¼tme) -->
            <div id="lightbox-modal" class="hidden" onclick="closeLightbox(event)">
                <button class="lightbox-close" onclick="closeLightbox(event)"><i class="fas fa-times"></i></button>
                <button class="lightbox-nav prev" onclick="changeLightboxImage(-1, event)"><i
                        class="fas fa-chevron-left"></i></button>

                <img id="lightbox-img" src="" alt="Full Memory">

                <button class="lightbox-nav next" onclick="changeLightboxImage(1, event)"><i
                        class="fas fa-chevron-right"></i></button>
            </div>

            <!-- Gizli Dosya YÃ¼kleme Inputu -->
            <input type="file" id="image-upload" accept="image/*" style="display: none;">
        </section>

        <!-- BULUÅMA ODASI (YENÄ°) -->
        <section id="meeting-room" class="room-section hidden">
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <!-- Sohbet AlanÄ± -->
            <div class="chat-container">
                <div class="chat-header">
                    <h2>ğŸ”¥ ÅÃ¶mine BaÅŸÄ± Sohbeti</h2>
                </div>
                <div class="chat-messages" id="chat-messages">
                    <!-- Mesajlar buraya gelecek -->
                    <div class="message system-message">
                        BuluÅŸma odasÄ±na hoÅŸ geldin... ÅÃ¶mine Ã§ok gÃ¼zel yanÄ±yor. ğŸ”¥
                    </div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chat-input" placeholder="Bir ÅŸeyler sÃ¶yle...">
                    <button id="send-btn"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
            </div>
        </section>

        <!-- OYUN ODASI (YENÄ°) -->
        <section id="game-room" class="room-section hidden">
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <div class="games-menu">
                <h2 class="games-title">ğŸ® Hangi Oyunu Oynamak Ä°stersin?</h2>
                <div class="game-buttons">
                    <button class="game-select-btn" id="btn-wheel-game">
                        <i class="fas fa-circle-notch"></i> Kader Ã‡arkÄ±
                    </button>
                    <button class="game-select-btn" id="btn-words-game">
                        <i class="fas fa-times-circle"></i> Yasak Kelimeler
                    </button>
                    <button class="game-select-btn" id="btn-quiz-game">
                        <i class="fas fa-heart"></i> AÅŸk Testi
                    </button>
                    <button class="game-select-btn" id="btn-trivia-game">
                        <i class="fas fa-brain"></i> Bilgi YarÄ±ÅŸmasÄ±
                    </button>
                </div>

                <!-- SON OYNANAN OYUNLAR (PERSISTENCE CHECK) -->
                <div id="recent-scores"
                    style="margin-top: 50px; color: white; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 15px; width: 90%; max-width: 500px;">
                    <!-- JS ile dolacak -->
                </div>
            </div>

            <!-- KADER Ã‡ARKI OYUNU -->
            <div class="game-container hidden" id="wheel-game-container">
                <button class="game-back-btn" id="wheel-back-btn">â—€ Geri</button>
                <h2 class="game-title">ğŸ¡ Kader Ã‡arkÄ±</h2>
                <div class="wheel-wrapper">
                    <canvas id="wheelCanvas" width="500" height="500"></canvas>
                    <div class="wheel-pointer"></div>
                </div>
                <button class="spin-btn" id="spin-btn">Ã‡EVÄ°R</button>
                <div class="wheel-result hidden" id="wheel-result"></div>
            </div>

            <!-- YASAK KELÄ°MELER OYUNU -->
            <div class="game-container hidden" id="words-game-container">
                <button class="game-back-btn" id="words-back-btn">â—€ Geri</button>
                <h2 class="game-title">ğŸš« Yasak Kelimeler</h2>
                <p class="words-instruction">Balonlara tÄ±kla ama yasaklÄ± olanÄ± patlatma!</p>
                <div class="words-playground" id="words-playground">
                    <!-- Kelimeler buraya JS ile gelecek -->
                </div>
                <div class="words-result hidden" id="words-result"></div>
            </div>

            <!-- AÅK TESTÄ° OYUNU -->
            <div class="game-container hidden" id="quiz-game-container">
                <button class="game-back-btn" id="quiz-back-btn">â—€ Geri</button>
                <h2 class="game-title">â¤ï¸ AÅŸk Testi</h2>
                <div class="quiz-container" id="quiz-container">
                    <!-- Soru buraya gelecek -->
                </div>
            </div>

            <!-- BÄ°LGÄ° YARIÅMASI OYUNU (YENÄ°) -->
            <div class="game-container hidden" id="trivia-game-container">
                <button class="game-back-btn" id="trivia-back-btn">â—€ Geri</button>
                <h2 class="game-title">ğŸ§  Bilgi YarÄ±ÅŸmasÄ±</h2>
                <div class="quiz-container" id="trivia-container">
                    <!-- JS ile dolacak -->
                </div>
            </div>
            </div>
        </section>

        <!-- Ã‡ALIÅMA ODASI (YENÄ°) -->
        <section id="working-room" class="room-section hidden">
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <!-- Study Menu -->
            <div id="study-menu" class="study-menu-container" data-aos="fade-up">
                <h2 class="memory-title" style="margin-bottom: 2rem;">Ã‡alÄ±ÅŸma OdasÄ± ğŸ“š</h2>
                <div class="study-options">
                    <div class="study-option-card" onclick="showFlashcards()">
                        <div class="icon-box"><i class="fas fa-layer-group"></i></div>
                        <h3>Ezber KartlarÄ±</h3>
                        <p>Ceza Maddeleri & AÃ§Ä±klamalar</p>
                    </div>
                    <div class="study-option-card" onclick="showSpeedLimits()">
                        <div class="icon-box"><i class="fas fa-tachometer-alt"></i></div>
                        <h3>HÄ±z Limitleri</h3>
                        <p>Yasal HÄ±z SÄ±nÄ±rlarÄ±</p>
                    </div>
                    <div class="study-option-card" onclick="showSigns()">
                        <div class="icon-box"><i class="fas fa-map-signs"></i></div>
                        <h3>Ä°ÅŸaret LevhalarÄ±</h3>
                        <p>Trafik Ä°ÅŸaretleri ve AnlamlarÄ±</p>
                    </div>
                    <div class="study-option-card" onclick="showNotes()">
                        <div class="icon-box"><i class="fas fa-clipboard-check"></i></div>
                        <h3>Ceza NotlarÄ±</h3>
                        <p>Plaka, Madde ve Tarih KaydÄ±</p>
                    </div>
                </div>
            </div>

            <!-- Flashcards Section -->
            <div id="flashcard-section" class="hidden study-sub-section">
                <div class="sub-header">
                    <button class="sub-back-btn" onclick="showStudyMenu()"><i class="fas fa-chevron-left"></i>
                        Geri</button>
                    <h3>Ezber KartlarÄ±</h3>
                </div>

                <!-- Admin / Add New Card Toggle -->
                <button class="toggle-add-btn" onclick="toggleAddCardForm()">+ Yeni Kart Ekle</button>
                <div id="add-card-form" class="add-data-form hidden">
                    <input type="text" id="new-card-term" placeholder="Terim / Madde (Ã–rn: Madde 51)">
                    <input type="text" id="new-card-def" placeholder="AÃ§Ä±klama">
                    <button onclick="addNewFlashcard()">Kaydet</button>
                </div>

                <div class="flashcard-wrapper">
                    <div class="flashcard" onclick="flipCard()">
                        <div class="card-face card-front">
                            <div class="card-icon"><i class="fas fa-question-circle"></i></div>
                            <div class="card-content" id="card-front">YÃ¼kleniyor...</div>
                            <div class="tap-hint">CevabÄ± gÃ¶rmek iÃ§in dokun</div>
                        </div>
                        <div class="card-face card-back">
                            <div class="card-icon"><i class="fas fa-exclamation-circle"></i></div>
                            <div class="card-content" id="card-back">YÃ¼kleniyor...</div>
                        </div>
                    </div>
                </div>

                <div class="flashcard-controls">
                    <button class="control-btn" onclick="prevCard()"><i class="fas fa-arrow-left"></i></button>
                    <span id="card-counter">1 / 10</span>
                    <button class="control-btn" onclick="nextCard()"><i class="fas fa-arrow-right"></i></button>
                </div>
                <p class="swipe-hint"><i class="fas fa-hand-pointer"></i> KaydÄ±rarak deÄŸiÅŸtir</p>
            </div>

            <!-- Speed Limits Section -->
            <div id="speed-limit-section" class="hidden study-sub-section">
                <div class="sub-header">
                    <button class="sub-back-btn" onclick="showStudyMenu()"><i class="fas fa-chevron-left"></i>
                        Geri</button>
                    <h3>HÄ±z Limitleri</h3>
                </div>
                <div id="speed-limits-container" class="speed-grid">
                    <!-- JS ile dolacak -->
                </div>
            </div>

            <!-- Signs Section -->
            <div id="signs-section" class="hidden study-sub-section">
                <div class="sub-header">
                    <button class="sub-back-btn" onclick="showStudyMenu()"><i class="fas fa-chevron-left"></i>
                        Geri</button>
                    <h3>Ä°ÅŸaret LevhalarÄ±</h3>
                </div>

                <!-- Admin / Add New Sign Toggle -->
                <button class="toggle-add-btn" onclick="toggleAddSignForm()">+ Yeni Levha Ekle</button>
                <div id="add-sign-form" class="add-data-form hidden">
                    <input type="text" id="new-sign-name" placeholder="Levha AdÄ±">
                    <input type="text" id="new-sign-icon" placeholder="Ä°kon / Emoji (Ã–rn: ğŸ›‘)">
                    <input type="text" id="new-sign-desc" placeholder="AÃ§Ä±klama">
                    <button onclick="addNewSign()">Kaydet</button>
                </div>

                <div id="signs-grid" class="signs-grid">
                    <!-- JS ile dolacak -->
                </div>
            </div>

            <!-- Note Taking Section (Ceza NotlarÄ±) -->
            <div id="notes-section" class="hidden study-sub-section">
                <div class="sub-header">
                    <button class="sub-back-btn" onclick="showStudyMenu()"><i class="fas fa-chevron-left"></i>
                        Geri</button>
                    <h3>Ceza NotlarÄ± ğŸ“</h3>
                </div>

                <!-- Not Ekleme Formu -->
                <div class="note-form-card">
                    <h4>Yeni KayÄ±t Ekle</h4>
                    <div class="note-inputs">
                        <input type="text" id="note-plate" placeholder="AraÃ§ PlakasÄ± (Ã¶rn: 34 ABC 123)">
                        <input type="text" id="note-article" placeholder="Ceza Maddesi (Ã¶rn: 51/2-a)">
                        <input type="text" id="note-location" placeholder="Yer / Konum">
                        <input type="datetime-local" id="note-date">
                    </div>
                    <button class="add-note-btn" onclick="addNote()">Kaydet <i class="fas fa-save"></i></button>
                </div>

                <!-- KayÄ±tlÄ± Notlar Listesi -->
                <div id="notes-list" class="notes-container">
                    <!-- JS ile dolacak -->
                    <p class="empty-notes">HenÃ¼z kaydedilmiÅŸ bir ceza notu yok.</p>
                </div>
            </div>
        </section>

        <!-- Ã–ZEL ODA (YENÄ°) -->
        <section id="private-room" class="room-section hidden">
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <div class="private-room-content">
                <div class="private-question-card">
                    <i class="fas fa-heart" style="font-size: 3rem; color: #e74c3c; margin-bottom: 20px;"></i>
                    <h2 class="private-question">Onunla beraber olsaydÄ±n ne yapardÄ±n?</h2>

                    <!-- TavÅŸan Cevap AlanÄ± -->
                    <div class="answer-section">
                        <div class="character-label">
                            <span class="character-emoji">ğŸ°</span>
                            <span class="character-name">TavÅŸan'Ä±n CevabÄ±</span>
                        </div>
                        <textarea id="rabbit-answer" class="private-answer-input"
                            placeholder="TavÅŸan, dÃ¼ÅŸÃ¼ncelerini buraya yaz..." rows="4"></textarea>
                    </div>

                    <!-- Tilki Cevap AlanÄ± -->
                    <div class="answer-section">
                        <div class="character-label">
                            <span class="character-emoji">ğŸ¦Š</span>
                            <span class="character-name">Tilki'nin CevabÄ±</span>
                        </div>
                        <textarea id="fox-answer" class="private-answer-input"
                            placeholder="Tilki, dÃ¼ÅŸÃ¼ncelerini buraya yaz..." rows="4"></textarea>
                    </div>

                    <!-- Kaydet Butonu -->
                    <button class="save-private-answer-btn" onclick="savePrivateAnswers()">
                        <i class="fas fa-save"></i> CevaplarÄ± Kaydet
                    </button>

                    <!-- KaydedilmiÅŸ Cevaplar -->
                    <div id="saved-answers-container" class="saved-answers-container hidden">
                        <h3>ğŸ’ KaydedilmiÅŸ Cevaplar</h3>
                        <div id="saved-answers-list">
                            <!-- JS ile dolacak -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Ã‡ALIKUÅU ODASI (YENÄ°) -->
        <section id="calikusu-room" class="room-section hidden">
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <h2 class="room-title" style="margin-bottom: 20px;"> Ã‡alÄ±kuÅŸunun DÃ¼nyasÄ± ğŸ¦</h2>

            <div class="calikusu-container">
                <!-- Tab BaÅŸlÄ±klarÄ± -->
                <div class="calikusu-tabs">
                    <button class="tab-btn active" onclick="openCmTab('todo')">YapÄ±lacaklar</button>
                    <button class="tab-btn" onclick="openCmTab('diary')">GÃ¼nlÃ¼k</button>
                </div>

                <!-- YapÄ±lacaklar Sekmesi -->
                <div id="tab-todo" class="tab-content active">
                    <div class="input-group">
                        <input type="text" id="todo-input" placeholder="BugÃ¼n ne yapmalÄ±yÄ±z?">
                        <button onclick="addTodo()" class="add-btn"><i class="fas fa-plus"></i></button>
                    </div>
                    <ul id="todo-list" class="styled-list">
                        <!-- JS ile dolacak -->
                    </ul>
                </div>

                <!-- GÃ¼nlÃ¼k Sekmesi -->
                <div id="tab-diary" class="tab-content">
                    <div class="diary-input-area">
                        <div class="date-picker-container" style="margin-bottom: 10px;">
                            <input type="date" id="diary-date-picker" class="styled-date-input">
                        </div>
                        <textarea id="diary-text" placeholder="Sevgili gÃ¼nlÃ¼k, bugÃ¼n..."></textarea>
                        <button onclick="saveDiaryEntry()" class="save-diary-btn">Kaydet</button>
                    </div>
                    <div id="diary-entries" class="entries-container">
                        <!-- GÃ¼nlÃ¼kler buraya -->
                    </div>
                </div>
            </div>
        </section>
        <!-- Ä°NGÄ°LÄ°ZCE ODASI (YENÄ°) -->
        <section id="english-room" class="room-section hidden">
            <div class="overlay"></div>

            <button class="back-btn" onclick="goBackToHall()">
                <i class="fas fa-arrow-left"></i> Hol'e DÃ¶n
            </button>

            <h2 class="room-title" style="margin-bottom: 20px;">English Academy ğŸ‡¬ğŸ‡§</h2>

            <div class="english-container">
                <!-- BaÅŸlangÄ±Ã§ / Ä°stek EkranÄ± -->
                <div id="english-welcome" class="english-welcome">
                    <i class="fas fa-graduation-cap" style="font-size: 5rem; color: #3498db; margin-bottom: 20px;"></i>
                    <h3>HazÄ±r mÄ±sÄ±n?</h3>
                    <p>Senin iÃ§in gÃ¼nlÃ¼k 20 adet B1 seviye kelime hazÄ±rlayabilirim.</p>
                    <button onclick="startDailyEnglish()" class="start-english-btn">
                        <i class="fas fa-magic"></i> Kelime Ã–ÄŸrenmek Ä°stiyorum
                    </button>
                    <!-- YÃ¼kleniyor GÃ¶stergesi -->
                    <div id="english-loading" class="hidden" style="margin-top: 20px;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #fff;"></i>
                        <p style="margin-top: 10px;">Sihirli kelimeler hazÄ±rlanÄ±yor...</p>
                    </div>
                </div>

                <!-- Kelime Listesi / Kart GÃ¶rÃ¼nÃ¼mÃ¼ -->
                <div id="english-content" class="english-content hidden">
                    <div class="english-header">
                        <span id="daily-topic-date">BugÃ¼nÃ¼n Kelimeleri</span>
                        <div style="display: flex; gap: 15px; align-items: center;">
                            <span id="word-progress-text" style="color: #fff; font-weight: bold;">1 / 20</span>
                            <button onclick="refreshEnglishWords()" class="refresh-btn" title="Yenile"><i
                                    class="fas fa-sync-alt"></i></button>
                        </div>
                    </div>

                    <div id="single-card-container" class="single-card-container">
                        <!-- JS ile tek kart dolacak -->
                    </div>

                    <div class="card-controls" id="card-controls">
                        <button onclick="nextEnglishWord()" class="learn-btn">
                            <i class="fas fa-check"></i> Ã–ÄŸrendim (SÄ±radaki)
                        </button>
                    </div>

                    <!-- BitiÅŸ EkranÄ± -->
                    <div id="english-completion" class="hidden" style="text-align: center; padding: 20px;">
                        <i class="fas fa-trophy" style="font-size: 4rem; color: #f1c40f; margin-bottom: 20px;"></i>
                        <h3>Tebrikler! ğŸ‰</h3>
                        <p>BugÃ¼nÃ¼n hedeflediÄŸin 20 kelimesini tamamladÄ±n.</p>
                        <button onclick="restartDailyEnglish()" class="start-english-btn" style="margin-top: 15px;">
                            <i class="fas fa-redo"></i> Tekrar Et
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- MÃœZÄ°K ODASI (YENÄ° - TAM EKRAN PLAYER) -->
        <!-- MÃœZÄ°K ODASI (PRO PLAYER DESIGN) -->
        <section id="music-room" class="room-section hidden" style="padding: 0; background: #0f0f13;">
            <div class="music-room-container">
                <!-- Arka Plan Efekti -->
                <div class="player-bg-effect"></div>

                <!-- Header -->
                <div class="player-header">
                    <button class="close-player-btn" onclick="goBackToHall()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <div class="player-title-head">Playing From Playlist</div>
                    <button class="close-player-btn" onclick=""> <!-- More options placeholder -->
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>

                <!-- Main Visual (Vinyl) -->
                <div class="player-visual">
                    <div class="vinyl-wrapper">
                        <div class="vinyl-disc" id="vinyl-record-ui">
                            <div class="vinyl-center"></div>
                        </div>
                    </div>
                </div>

                <!-- Controls & Info Area -->
                <div class="player-controls-area">
                    <!-- Track Info -->
                    <div class="track-info-display">
                        <div class="track-title-lg" id="current-track-title">ParÃ§a SeÃ§iniz</div>
                        <div class="track-artist-lg" id="current-track-artist">MÃ¼zik Ã‡alar</div>
                    </div>

                    <!-- Progress Bar -->
                    <div class="progress-container" id="progress-container">
                        <div class="progress-bar" id="progress-bar">
                            <div class="progress-handle"></div>
                        </div>
                    </div>
                    <div class="time-stamps">
                        <span id="current-time">0:00</span>
                        <span id="total-duration">0:00</span>
                    </div>

                    <!-- Main Buttons -->
                    <div class="control-buttons-row">
                        <button class="ctrl-btn" id="shuffle-btn"><i class="fas fa-random"></i></button>
                        <button class="ctrl-btn" onclick="playPrev()"><i class="fas fa-step-backward"></i></button>

                        <button class="play-pause-btn" id="main-play-btn" onclick="togglePlay()">
                            <i class="fas fa-play"></i>
                        </button>

                        <button class="ctrl-btn" onclick="playNext()"><i class="fas fa-step-forward"></i></button>
                        <button class="ctrl-btn" id="repeat-btn"><i class="fas fa-redo"></i></button>
                    </div>

                    <!-- Footer Actions -->
                    <div class="player-footer">
                        <button class="volume-btn"><i class="fas fa-volume-up"></i></button>
                        <button class="playlist-toggle-btn" onclick="togglePlaylistDrawer()">
                            <i class="fas fa-list-ul"></i> SÄ±radaki ParÃ§alar
                        </button>
                        <button class="volume-btn"><i class="fas fa-share-alt"></i></button>
                    </div>
                </div>

                <!-- PLAYLIST DRAWER (Ã‡EKMECE) -->
                <div class="drawer-overlay" id="drawer-overlay" onclick="togglePlaylistDrawer()"></div>
                <div class="playlist-drawer" id="playlist-drawer">
                    <div class="drawer-header">
                        <h3>SÄ±radaki ParÃ§alar</h3>
                        <button class="close-drawer-btn" onclick="togglePlaylistDrawer()">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>

                    <div class="drawer-upload-area">
                        <label for="mp3-input" class="upload-btn-full">
                            <i class="fas fa-file-audio"></i> Yeni MÃ¼zik Ekle
                        </label>
                        <input type="file" id="mp3-input" accept="audio/mp3,audio/*" style="display: none;"
                            onchange="addMp3Track(this)">
                    </div>

                    <div class="playlist-content">
                        <ul id="playlist" class="styled-playlist">
                            <!-- JS ile liste buraya dolacak -->
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <!-- MÃœZÄ°K OYNATICI (YENÄ°LENMÄ°Å) -->
        <!-- MÃœZÄ°K OYNATICI (YENÄ°LENMÄ°Å) - KALDIRILDI (YENÄ° ODAYA TAÅINIYOR) -->
        <!-- <div id="music-player-container" class="hidden">
        <div id="youtube-player-placeholder" style="display:none;"></div>
        ...
    </div> -->



        <!-- Scripts -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
        <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
        <script src="js/telegram-notifications.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="js/supabase-client.js"></script>
        <script src="js/music-db.js"></script> <!-- MÃ¼zik VeritabanÄ± Eklendi -->
        <script src="js/main.js?v=4"></script> <!-- Versiyon gÃ¼ncellendi -->
        <script src="js/quiz-game.js?v=3"></script>
        <script src="js/trivia-game.js?v=3"></script>
        <script src="js/study-room.js?v=3"></script>
        <script src="js/games.js?v=3"></script>

        <!-- MOBILE BOTTOM NAVIGATION REMOVED -->

        <script>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function () {
                    navigator.serviceWorker.register('./sw.js').then(function (registration) {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    }, function (err) {
                        console.log('ServiceWorker registration failed: ', err);
                    });
                });
            }
        </script>
</body>

</html>